# To use this file, run `docker-compose up`.
version: '3'

services:
  # Eosio node
  eosio_nodeos:
    build: eosio
    container_name: nodeos
    volumes:
      - eosio-blocks:/eosio/blocks
      - eosio-data:/eosio/data
    ports:
      - "8888:8888"
      - "9876:9876"
    networks:
      volentix:
        ipv4_address: 172.20.0.5

  # Ethereum node
  ethereum_parity:
    build: ethereum
    container_name: parity
    volumes:
      - ethereum-data:/ethereum/data
    ports:
      - "30304:30304"
      - "8546:8546"
      - "8547:8547"
    networks:
      volentix:
        ipv4_address: 172.20.0.4

  # Main application
  bitcoin-core:
    image: volentix/vdexnode_bitcoin-core:latest
    container_name: bitcoin
    volumes:
      - bitcoin-data:/home/bitcoin/.bitcoin
    expose:
      - "18443"
      - "18444"
    ports:
      - "18443:18443"
      - "18444:18444"
    command:
      -printtoconsole
      -regtest=1
      -rpcbind=0.0.0.0
      -rpcallowip=172.20.0.0/24
      -rpcauth='sylvain:61ec18acbeb8975bada6286075456714$f5995cc314abd21db9b2ba60a26d38f10946def4325f1c6a7d768f681c706c52'  # EDIT THIS VALUE!
    networks:
      volentix:
        ipv4_address: 172.20.0.2

  vdexnode:
    image: volentix/vdexnode:latest
    container_name: vdexnode
    environment: # EDIT THESE VALUES!
      - IP=198.50.136.143 # Comment to transform into a bootstrap
      - EOSKEY=EOS6PdTCWZgWMh4s5EDxYK3aL6DPC2ksDusTQpxE38QVmUzYLjLt9
      - BITCOIN_USER=sylvain
      - BITCOIN_PASS=VBtu_InZ1oTL1oeKkZbSm97QzLMTPr0yvo6AFY0GFT4=
      - BITCOIN_ENDPOINT=bitcoin
      - BITCOIN_PORT=18443
    expose:
      - "4222"
      - "8000"
    ports:
      - "4222:4222/udp"
      - "8000:8000"
    command:
      server
    networks:
      volentix:
        ipv4_address: 172.20.0.3

volumes:
  bitcoin-data:
  ethereum-data:
  eosio-blocks:
  eosio-data:

networks:
  volentix:
    driver: bridge
    ipam:
      driver: default
      config:
      - subnet: 172.20.0.0/24
